<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SCAPE+: vertical_grid Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SCAPE+
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacevertical__grid.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">vertical_grid Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Support functions added to support the SCAPE vertical grid enhancement.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:afbec2b78b627acc80062bdc83f1943bb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#afbec2b78b627acc80062bdc83f1943bb">get_layers</a> (success_code)</td></tr>
<tr class="memdesc:afbec2b78b627acc80062bdc83f1943bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads data giving layer properties.  <a href="#afbec2b78b627acc80062bdc83f1943bb">More...</a><br /></td></tr>
<tr class="separator:afbec2b78b627acc80062bdc83f1943bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac891eaf92b326d9a47f9aaccc56a8cf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#aac891eaf92b326d9a47f9aaccc56a8cf">read_profile</a> (unitNo, filename, profile_start, profile_start2, profile_end, base_geology, success_code)</td></tr>
<tr class="memdesc:aac891eaf92b326d9a47f9aaccc56a8cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads base geology or layer profile from a file of Y - Z or Y - Depth values.  <a href="#aac891eaf92b326d9a47f9aaccc56a8cf">More...</a><br /></td></tr>
<tr class="separator:aac891eaf92b326d9a47f9aaccc56a8cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af91b1ef3732ecbaba17473c83956b5b5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#af91b1ef3732ecbaba17473c83956b5b5">interpolate_profile</a> (profile_start, profile_end, profile, success_code)</td></tr>
<tr class="memdesc:af91b1ef3732ecbaba17473c83956b5b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates between points in a base geology or layer profile to set values in the vertical grid.  <a href="#af91b1ef3732ecbaba17473c83956b5b5">More...</a><br /></td></tr>
<tr class="separator:af91b1ef3732ecbaba17473c83956b5b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad17c3a4e6499466c0c0cd1616e9d0cb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#aad17c3a4e6499466c0c0cd1616e9d0cb">interpolate_profile_value</a> (profile, index, y1, z1, y2, z2)</td></tr>
<tr class="memdesc:aad17c3a4e6499466c0c0cd1616e9d0cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate values from a user base geology profile or layer profile.  <a href="#aad17c3a4e6499466c0c0cd1616e9d0cb">More...</a><br /></td></tr>
<tr class="separator:aad17c3a4e6499466c0c0cd1616e9d0cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8a0f3f7432908ec2daf1fb5803bf12a"><td class="memItemLeft" align="right" valign="top">real(kind=double) real(kind=double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#aa8a0f3f7432908ec2daf1fb5803bf12a">interpolate_y_value</a> (z, y1, z1, y2, z2)</td></tr>
<tr class="memdesc:aa8a0f3f7432908ec2daf1fb5803bf12a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate value y value along a y-z line.  <a href="#aa8a0f3f7432908ec2daf1fb5803bf12a">More...</a><br /></td></tr>
<tr class="separator:aa8a0f3f7432908ec2daf1fb5803bf12a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdec9eefca7e3a8080ced48c2119d79b"><td class="memItemLeft" align="right" valign="top">real(kind=double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#acdec9eefca7e3a8080ced48c2119d79b">interpolate_z_value</a> (y, y1, z1, y2, z2)</td></tr>
<tr class="memdesc:acdec9eefca7e3a8080ced48c2119d79b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate value z value along a y-z line.  <a href="#acdec9eefca7e3a8080ced48c2119d79b">More...</a><br /></td></tr>
<tr class="separator:acdec9eefca7e3a8080ced48c2119d79b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20921b1398088acb37b56f26ccce3cb7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a20921b1398088acb37b56f26ccce3cb7">get_base_profile</a> (success_code)</td></tr>
<tr class="memdesc:a20921b1398088acb37b56f26ccce3cb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads base geology data and profile from a file of Y - Z values.  <a href="#a20921b1398088acb37b56f26ccce3cb7">More...</a><br /></td></tr>
<tr class="separator:a20921b1398088acb37b56f26ccce3cb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c7cc7c8cc26a468cfb4b46d6fb85603"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a6c7cc7c8cc26a468cfb4b46d6fb85603">get_y_values_from_profiles</a> (nYsections, nce, cliffy)</td></tr>
<tr class="memdesc:a6c7cc7c8cc26a468cfb4b46d6fb85603"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises cliffy values from the base geology and layer profiles.  <a href="#a6c7cc7c8cc26a468cfb4b46d6fb85603">More...</a><br /></td></tr>
<tr class="separator:a6c7cc7c8cc26a468cfb4b46d6fb85603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c9ae156ee9ae50059e3b2b2695387a7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a7c9ae156ee9ae50059e3b2b2695387a7">cut_layer_profiles</a> (nYsections, nce, cliffy)</td></tr>
<tr class="memdesc:a7c9ae156ee9ae50059e3b2b2695387a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cut the base geology and layer profiles to match current cliffy values.  <a href="#a7c9ae156ee9ae50059e3b2b2695387a7">More...</a><br /></td></tr>
<tr class="separator:a7c9ae156ee9ae50059e3b2b2695387a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d0cec93533fa0f225c0b28f6168e76b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a8d0cec93533fa0f225c0b28f6168e76b">add_new_layer</a> (section, strength, sediment, volume, thickness, yPosition, success_code)</td></tr>
<tr class="memdesc:a8d0cec93533fa0f225c0b28f6168e76b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new layer and add material to it.  <a href="#a8d0cec93533fa0f225c0b28f6168e76b">More...</a><br /></td></tr>
<tr class="separator:a8d0cec93533fa0f225c0b28f6168e76b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ee7bf5bb1b9c0ef66db539eb67f6b32"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a6ee7bf5bb1b9c0ef66db539eb67f6b32">add_material_to_layer</a> (nLayer, section, volume, thickness, yPosition, success_code)</td></tr>
<tr class="memdesc:a6ee7bf5bb1b9c0ef66db539eb67f6b32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add material to an existing layer.  <a href="#a6ee7bf5bb1b9c0ef66db539eb67f6b32">More...</a><br /></td></tr>
<tr class="separator:a6ee7bf5bb1b9c0ef66db539eb67f6b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5041a37d436b5526b1941a48e13f48cc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a5041a37d436b5526b1941a48e13f48cc">get_cell_values</a> (zValue, yIndex, section, strength, sediment)</td></tr>
<tr class="memdesc:a5041a37d436b5526b1941a48e13f48cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the strength and sediment content values for a cell.  <a href="#a5041a37d436b5526b1941a48e13f48cc">More...</a><br /></td></tr>
<tr class="separator:a5041a37d436b5526b1941a48e13f48cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a285097ba1d5a12fad5e8e5cfff4f3844"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a285097ba1d5a12fad5e8e5cfff4f3844">get_cell_dominant_layer</a> (zValue, yIndex, section)</td></tr>
<tr class="memdesc:a285097ba1d5a12fad5e8e5cfff4f3844"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an int indicating whether the HA grid cell of interest is empty, or which of the base geology layer or one of the layers above covers most of the sell area.  <a href="#a285097ba1d5a12fad5e8e5cfff4f3844">More...</a><br /></td></tr>
<tr class="separator:a285097ba1d5a12fad5e8e5cfff4f3844"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ccdc45c90a72e9e81c12d62774b9df9"><td class="memItemLeft" align="right" valign="top">real(kind=double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a5ccdc45c90a72e9e81c12d62774b9df9">base_profile_value</a> (yIndex, section)</td></tr>
<tr class="memdesc:a5ccdc45c90a72e9e81c12d62774b9df9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the base profile value at a cell boundary.  <a href="#a5ccdc45c90a72e9e81c12d62774b9df9">More...</a><br /></td></tr>
<tr class="separator:a5ccdc45c90a72e9e81c12d62774b9df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b5834ac3b074eda245ab5e2cfcdeea2"><td class="memItemLeft" align="right" valign="top">real(kind=double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a4b5834ac3b074eda245ab5e2cfcdeea2">layer_profile_value</a> (yIndex, layer, section)</td></tr>
<tr class="memdesc:a4b5834ac3b074eda245ab5e2cfcdeea2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a layer profile value at a cell boundary.  <a href="#a4b5834ac3b074eda245ab5e2cfcdeea2">More...</a><br /></td></tr>
<tr class="separator:a4b5834ac3b074eda245ab5e2cfcdeea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af18a7dc7a165860e65bb9356ed570b55"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#af18a7dc7a165860e65bb9356ed570b55">init_profile_point_storage</a> (success_code)</td></tr>
<tr class="memdesc:af18a7dc7a165860e65bb9356ed570b55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the variables and arrays used when reading profiles.  <a href="#af18a7dc7a165860e65bb9356ed570b55">More...</a><br /></td></tr>
<tr class="separator:af18a7dc7a165860e65bb9356ed570b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac633158e3ef0d502e66bef5e52b09393"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#ac633158e3ef0d502e66bef5e52b09393">add_profile_point</a> (y, z, success_code)</td></tr>
<tr class="memdesc:ac633158e3ef0d502e66bef5e52b09393"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the next point to the current base geology or layer profile.  <a href="#ac633158e3ef0d502e66bef5e52b09393">More...</a><br /></td></tr>
<tr class="separator:ac633158e3ef0d502e66bef5e52b09393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08dea04c23cf1e53315d634c7084a5c2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a08dea04c23cf1e53315d634c7084a5c2">save_profile_points</a> (success_code)</td></tr>
<tr class="memdesc:a08dea04c23cf1e53315d634c7084a5c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called after all the profile points have been read in.  <a href="#a08dea04c23cf1e53315d634c7084a5c2">More...</a><br /></td></tr>
<tr class="separator:a08dea04c23cf1e53315d634c7084a5c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ee4f9554f6d6710a348b6e4f2e7198f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a0ee4f9554f6d6710a348b6e4f2e7198f">finish_va_grid</a> ()</td></tr>
<tr class="memdesc:a0ee4f9554f6d6710a348b6e4f2e7198f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocates vertical grid storage.  <a href="#a0ee4f9554f6d6710a348b6e4f2e7198f">More...</a><br /></td></tr>
<tr class="separator:a0ee4f9554f6d6710a348b6e4f2e7198f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7d4b3aef1beffb7cbe7cea5a4eb75c0e"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a7d4b3aef1beffb7cbe7cea5a4eb75c0e">nhcells</a></td></tr>
<tr class="memdesc:a7d4b3aef1beffb7cbe7cea5a4eb75c0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of horizontal cells.  <a href="#a7d4b3aef1beffb7cbe7cea5a4eb75c0e">More...</a><br /></td></tr>
<tr class="separator:a7d4b3aef1beffb7cbe7cea5a4eb75c0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ec9d55ece6690bda47a5c06766d4546"><td class="memItemLeft" align="right" valign="top">real(kind=double), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a9ec9d55ece6690bda47a5c06766d4546">temp_y_1</a></td></tr>
<tr class="memdesc:a9ec9d55ece6690bda47a5c06766d4546"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporary y value storage.  <a href="#a9ec9d55ece6690bda47a5c06766d4546">More...</a><br /></td></tr>
<tr class="separator:a9ec9d55ece6690bda47a5c06766d4546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9aaf12df89243d36a4e7808323da457"><td class="memItemLeft" align="right" valign="top">real(kind=double), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#af9aaf12df89243d36a4e7808323da457">temp_z_1</a></td></tr>
<tr class="memdesc:af9aaf12df89243d36a4e7808323da457"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporary z value storage.  <a href="#af9aaf12df89243d36a4e7808323da457">More...</a><br /></td></tr>
<tr class="separator:af9aaf12df89243d36a4e7808323da457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a81934e4a8bf12f697018247e1f949c"><td class="memItemLeft" align="right" valign="top">real(kind=double), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a1a81934e4a8bf12f697018247e1f949c">temp_y_2</a></td></tr>
<tr class="memdesc:a1a81934e4a8bf12f697018247e1f949c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporary y value storage.  <a href="#a1a81934e4a8bf12f697018247e1f949c">More...</a><br /></td></tr>
<tr class="separator:a1a81934e4a8bf12f697018247e1f949c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a850f766e5d65ed3c9bad6d8aade0eb22"><td class="memItemLeft" align="right" valign="top">real(kind=double), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a850f766e5d65ed3c9bad6d8aade0eb22">temp_z_2</a></td></tr>
<tr class="memdesc:a850f766e5d65ed3c9bad6d8aade0eb22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporary z value storage.  <a href="#a850f766e5d65ed3c9bad6d8aade0eb22">More...</a><br /></td></tr>
<tr class="separator:a850f766e5d65ed3c9bad6d8aade0eb22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae246916d5b34df364b4702a154ccfa6c"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#ae246916d5b34df364b4702a154ccfa6c">active_temp_points</a></td></tr>
<tr class="memdesc:ae246916d5b34df364b4702a154ccfa6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates which temp arrays are active (1 or 2)  <a href="#ae246916d5b34df364b4702a154ccfa6c">More...</a><br /></td></tr>
<tr class="separator:ae246916d5b34df364b4702a154ccfa6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e721b3b8c6bf3080ea7de2c4fcb9e5"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a68e721b3b8c6bf3080ea7de2c4fcb9e5">index_limit</a></td></tr>
<tr class="memdesc:a68e721b3b8c6bf3080ea7de2c4fcb9e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current dimension of temp arrays.  <a href="#a68e721b3b8c6bf3080ea7de2c4fcb9e5">More...</a><br /></td></tr>
<tr class="separator:a68e721b3b8c6bf3080ea7de2c4fcb9e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4496d95a390b57e04da287ab7a728e9d"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevertical__grid.html#a4496d95a390b57e04da287ab7a728e9d">next_index</a></td></tr>
<tr class="memdesc:a4496d95a390b57e04da287ab7a728e9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Next subscript in temp arrays.  <a href="#a4496d95a390b57e04da287ab7a728e9d">More...</a><br /></td></tr>
<tr class="separator:a4496d95a390b57e04da287ab7a728e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Support functions added to support the SCAPE vertical grid enhancement. </p>
<p>Base geology has a strength value and a sediment contant value and an extent defined by a Y - Z profile extending seaward to Z = 0.</p>
<p>Layers above have a strength value and a sediment content value and an extent defined by a Y - Depth profile extending seaward to Y = YmaxH, where YmaxH is user-defined.</p>
<p>Vertical grid constructed from the base geology and the layers extends horixontally from Y = 0 to Y = YmaxH. The grid spacings are user-defined values, dy and dz. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a6ee7bf5bb1b9c0ef66db539eb67f6b32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::add_material_to_layer </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nLayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>volume</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>yPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>success_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add material to an existing layer. </p>
<p>Calculates the number of cells required to achieve the required volume as a layer of the required thickness. Centres the cells near the required yPosition. Adds a two cell wide taper to the layer at each end.</p>
<p>The requested volume is always achieved exactly. The position and thickness arguments are treated as targets.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nlayer</td><td>Layer index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">section</td><td>Beach section index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">volume</td><td>Volume of material to add to layer</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thickness</td><td>Target maximum thickness of added material</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yposition</td><td>Target y position at middle of added material</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">success_code</td><td>0: ok, -ive fatal error, +ive warning </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00640">640</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a6ee7bf5bb1b9c0ef66db539eb67f6b32_cgraph.png" border="0" usemap="#namespacevertical__grid_a6ee7bf5bb1b9c0ef66db539eb67f6b32_cgraph" alt=""/></div>
<map name="namespacevertical__grid_a6ee7bf5bb1b9c0ef66db539eb67f6b32_cgraph" id="namespacevertical__grid_a6ee7bf5bb1b9c0ef66db539eb67f6b32_cgraph">
<area shape="rect" id="node2" href="namespaceexceptions.html#adb88d6f61ab18ab53a1d0c7c7022af3c" title="Log a failure message. " alt="" coords="181,13,365,39"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a6ee7bf5bb1b9c0ef66db539eb67f6b32_icgraph.png" border="0" usemap="#namespacevertical__grid_a6ee7bf5bb1b9c0ef66db539eb67f6b32_icgraph" alt=""/></div>
<map name="namespacevertical__grid_a6ee7bf5bb1b9c0ef66db539eb67f6b32_icgraph" id="namespacevertical__grid_a6ee7bf5bb1b9c0ef66db539eb67f6b32_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#a8d0cec93533fa0f225c0b28f6168e76b" title="Add a new layer and add material to it. " alt="" coords="181,5,300,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8d0cec93533fa0f225c0b28f6168e76b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::add_new_layer </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>sediment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>volume</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>yPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>success_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new layer and add material to it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">section</td><td>Beach section index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">strength</td><td>Strength of layer material</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sediment</td><td>Sediment content of layer</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">volume</td><td>Volume of material to add to layer</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thickness</td><td>Target maximum thickness of added material</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yposition</td><td>Target y position at middle of added material</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">success_code</td><td>0: ok, -ive fatal error, +ive warning </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00598">598</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a8d0cec93533fa0f225c0b28f6168e76b_cgraph.png" border="0" usemap="#namespacevertical__grid_a8d0cec93533fa0f225c0b28f6168e76b_cgraph" alt=""/></div>
<map name="namespacevertical__grid_a8d0cec93533fa0f225c0b28f6168e76b_cgraph" id="namespacevertical__grid_a8d0cec93533fa0f225c0b28f6168e76b_cgraph">
<area shape="rect" id="node2" href="namespaceexceptions.html#adb88d6f61ab18ab53a1d0c7c7022af3c" title="Log a failure message. " alt="" coords="348,13,532,39"/>
<area shape="rect" id="node3" href="namespacevertical__grid.html#a6ee7bf5bb1b9c0ef66db539eb67f6b32" title="Add material to an existing layer. " alt="" coords="172,35,300,76"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac633158e3ef0d502e66bef5e52b09393"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::add_profile_point </td>
          <td>(</td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>success_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add the next point to the current base geology or layer profile. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Y value</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Z value</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">success_code</td><td>0: ok, -ive fatal error, +ive warning </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00939">939</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_ac633158e3ef0d502e66bef5e52b09393_cgraph.png" border="0" usemap="#namespacevertical__grid_ac633158e3ef0d502e66bef5e52b09393_cgraph" alt=""/></div>
<map name="namespacevertical__grid_ac633158e3ef0d502e66bef5e52b09393_cgraph" id="namespacevertical__grid_ac633158e3ef0d502e66bef5e52b09393_cgraph">
<area shape="rect" id="node2" href="namespaceexceptions.html#ab1982976e08c1eb3195c39be80d42c76" title="Test allocation result to return success code. " alt="" coords="172,5,323,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_ac633158e3ef0d502e66bef5e52b09393_icgraph.png" border="0" usemap="#namespacevertical__grid_ac633158e3ef0d502e66bef5e52b09393_icgraph" alt=""/></div>
<map name="namespacevertical__grid_ac633158e3ef0d502e66bef5e52b09393_icgraph" id="namespacevertical__grid_ac633158e3ef0d502e66bef5e52b09393_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#aac891eaf92b326d9a47f9aaccc56a8cf" title="Reads base geology or layer profile from a file of Y &#45; Z or Y &#45; Depth values. " alt="" coords="172,5,295,47"/>
<area shape="rect" id="node3" href="namespacevertical__grid.html#afbec2b78b627acc80062bdc83f1943bb" title="Reads data giving layer properties. " alt="" coords="507,5,623,47"/>
<area shape="rect" id="node6" href="namespacevertical__grid.html#a20921b1398088acb37b56f26ccce3cb7" title="Reads base geology data and profile from a file of Y &#45; Z values. " alt="" coords="343,35,459,76"/>
<area shape="rect" id="node4" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="671,5,797,47"/>
<area shape="rect" id="node5" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="845,13,980,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5ccdc45c90a72e9e81c12d62774b9df9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=double) function vertical_grid::base_profile_value </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>yIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>section</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the base profile value at a cell boundary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">yindex</td><td>Horizontal index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">section</td><td>Beach section index </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00848">848</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a5ccdc45c90a72e9e81c12d62774b9df9_cgraph.png" border="0" usemap="#namespacevertical__grid_a5ccdc45c90a72e9e81c12d62774b9df9_cgraph" alt=""/></div>
<map name="namespacevertical__grid_a5ccdc45c90a72e9e81c12d62774b9df9_cgraph" id="namespacevertical__grid_a5ccdc45c90a72e9e81c12d62774b9df9_cgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#acdec9eefca7e3a8080ced48c2119d79b" title="Interpolate value z value along a y&#45;z line. " alt="" coords="180,5,339,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a5ccdc45c90a72e9e81c12d62774b9df9_icgraph.png" border="0" usemap="#namespacevertical__grid_a5ccdc45c90a72e9e81c12d62774b9df9_icgraph" alt=""/></div>
<map name="namespacevertical__grid_a5ccdc45c90a72e9e81c12d62774b9df9_icgraph" id="namespacevertical__grid_a5ccdc45c90a72e9e81c12d62774b9df9_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#a6c7cc7c8cc26a468cfb4b46d6fb85603" title="Initialises cliffy values from the base geology and layer profiles. " alt="" coords="372,5,531,47"/>
<area shape="rect" id="node5" href="namespacevertical__grid.html#a285097ba1d5a12fad5e8e5cfff4f3844" title="Returns an int indicating whether the HA grid cell of interest is empty, or which of the base geology..." alt="" coords="180,68,324,109"/>
<area shape="rect" id="node3" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="1009,8,1136,49"/>
<area shape="rect" id="node4" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="1184,45,1319,71"/>
<area shape="rect" id="node6" href="namespacevertical__grid.html#a5041a37d436b5526b1941a48e13f48cc" title="Get the strength and sediment content values for a cell. " alt="" coords="393,71,509,112"/>
<area shape="rect" id="node7" href="namespaceplatform__erosion__module.html#a0d5710fa3ad3969b963d00d269cc50e8" title="Apply platform erosion to the whole beach. " alt="" coords="579,68,745,109"/>
<area shape="rect" id="node8" href="namespacetimestep__module.html#ab7438249ea2939c60b42804aea100c8d" title="timestep_module::update" alt="" coords="793,74,961,101"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7c9ae156ee9ae50059e3b2b2695387a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::cut_layer_profiles </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nYsections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), dimension(nce, nysections), intent(inout)&#160;</td>
          <td class="paramname"><em>cliffy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cut the base geology and layer profiles to match current cliffy values. </p>
<p>Only modifies the profiles in the range Y = 0 to YmaxH</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nysections</td><td>number of beach sections</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nce</td><td>number of cliff elements</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cliffy</td><td>discretised cliff y value </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00526">526</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a7c9ae156ee9ae50059e3b2b2695387a7_cgraph.png" border="0" usemap="#namespacevertical__grid_a7c9ae156ee9ae50059e3b2b2695387a7_cgraph" alt=""/></div>
<map name="namespacevertical__grid_a7c9ae156ee9ae50059e3b2b2695387a7_cgraph" id="namespacevertical__grid_a7c9ae156ee9ae50059e3b2b2695387a7_cgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#acdec9eefca7e3a8080ced48c2119d79b" title="Interpolate value z value along a y&#45;z line. " alt="" coords="169,5,328,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0ee4f9554f6d6710a348b6e4f2e7198f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::finish_va_grid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocates vertical grid storage. </p>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l01029">1029</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a0ee4f9554f6d6710a348b6e4f2e7198f_cgraph.png" border="0" usemap="#namespacevertical__grid_a0ee4f9554f6d6710a348b6e4f2e7198f_cgraph" alt=""/></div>
<map name="namespacevertical__grid_a0ee4f9554f6d6710a348b6e4f2e7198f_cgraph" id="namespacevertical__grid_a0ee4f9554f6d6710a348b6e4f2e7198f_cgraph">
<area shape="rect" id="node2" href="namespaceexceptions.html#ab1982976e08c1eb3195c39be80d42c76" title="Test allocation result to return success code. " alt="" coords="181,5,332,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a0ee4f9554f6d6710a348b6e4f2e7198f_icgraph.png" border="0" usemap="#namespacevertical__grid_a0ee4f9554f6d6710a348b6e4f2e7198f_icgraph" alt=""/></div>
<map name="namespacevertical__grid_a0ee4f9554f6d6710a348b6e4f2e7198f_icgraph" id="namespacevertical__grid_a0ee4f9554f6d6710a348b6e4f2e7198f_icgraph">
<area shape="rect" id="node2" href="namespacefinish__module.html#aef7a822436d28c55c2b36be21af18750" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="181,13,320,39"/>
<area shape="rect" id="node3" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="368,13,503,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a20921b1398088acb37b56f26ccce3cb7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::get_base_profile </td>
          <td>(</td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>success_code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads base geology data and profile from a file of Y - Z values. </p>
<p>Call read_profile to validates the profile and to get and store the profile points.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">success_code</td><td>0: ok, -ive fatal error, +ive warning </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00381">381</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a20921b1398088acb37b56f26ccce3cb7_cgraph.png" border="0" usemap="#namespacevertical__grid_a20921b1398088acb37b56f26ccce3cb7_cgraph" alt=""/></div>
<map name="namespacevertical__grid_a20921b1398088acb37b56f26ccce3cb7_cgraph" id="namespacevertical__grid_a20921b1398088acb37b56f26ccce3cb7_cgraph">
<area shape="rect" id="node2" href="namespaceutilities__module.html#a88861ad97c41598219fab3b77fe685e5" title="Opens a text file for input and return a success_code value. " alt="" coords="169,5,313,47"/>
<area shape="rect" id="node4" href="namespaceexceptions.html#abeff94ba7cb1b2eea71e2ab64b2ba5af" title="Test iostat to return success code. " alt="" coords="382,64,525,105"/>
<area shape="rect" id="node5" href="namespacevertical__grid.html#aac891eaf92b326d9a47f9aaccc56a8cf" title="Reads base geology or layer profile from a file of Y &#45; Z or Y &#45; Depth values. " alt="" coords="180,123,303,164"/>
<area shape="rect" id="node3" href="namespaceutilities__module.html#a9a22dc4f187ed32c895a2404550f749f" title="Support for FluidEarth (OpenMI) logging. " alt="" coords="380,13,527,39"/>
<area shape="rect" id="node6" href="namespaceexceptions.html#adb88d6f61ab18ab53a1d0c7c7022af3c" title="Log a failure message. " alt="" coords="361,130,545,157"/>
<area shape="rect" id="node7" href="namespacevertical__grid.html#ac633158e3ef0d502e66bef5e52b09393" title="Add the next point to the current base geology or layer profile. " alt="" coords="394,181,513,223"/>
<area shape="rect" id="node8" href="namespaceexceptions.html#ab1982976e08c1eb3195c39be80d42c76" title="Test allocation result to return success code. " alt="" coords="593,181,744,223"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a20921b1398088acb37b56f26ccce3cb7_icgraph.png" border="0" usemap="#namespacevertical__grid_a20921b1398088acb37b56f26ccce3cb7_icgraph" alt=""/></div>
<map name="namespacevertical__grid_a20921b1398088acb37b56f26ccce3cb7_icgraph" id="namespacevertical__grid_a20921b1398088acb37b56f26ccce3cb7_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#afbec2b78b627acc80062bdc83f1943bb" title="Reads data giving layer properties. " alt="" coords="169,5,285,47"/>
<area shape="rect" id="node3" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="333,5,460,47"/>
<area shape="rect" id="node4" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="508,13,643,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a285097ba1d5a12fad5e8e5cfff4f3844"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function vertical_grid::get_cell_dominant_layer </td>
          <td>(</td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>zValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>yIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>section</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns an int indicating whether the HA grid cell of interest is empty, or which of the base geology layer or one of the layers above covers most of the sell area. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">zvalue</td><td>Z value relatice to OD of a point within the cell</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yindex</td><td>Horizontal index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">section</td><td>Beach section index</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Result: -1 indicates the cell is empty; 0 indicates the base geology layer predominates; Greater than 0 indicates which of the upper layers covers most of the cell area. </dd></dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00755">755</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a285097ba1d5a12fad5e8e5cfff4f3844_cgraph.png" border="0" usemap="#namespacevertical__grid_a285097ba1d5a12fad5e8e5cfff4f3844_cgraph" alt=""/></div>
<map name="namespacevertical__grid_a285097ba1d5a12fad5e8e5cfff4f3844_cgraph" id="namespacevertical__grid_a285097ba1d5a12fad5e8e5cfff4f3844_cgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#a5ccdc45c90a72e9e81c12d62774b9df9" title="Returns the base profile value at a cell boundary. " alt="" coords="213,5,340,47"/>
<area shape="rect" id="node4" href="namespacevertical__grid.html#aa8a0f3f7432908ec2daf1fb5803bf12a" title="Interpolate value y value along a y&#45;z line. " alt="" coords="197,71,356,112"/>
<area shape="rect" id="node5" href="namespacevertical__grid.html#a4b5834ac3b074eda245ab5e2cfcdeea2" title="Returns a layer profile value at a cell boundary. " alt="" coords="213,136,340,177"/>
<area shape="rect" id="node3" href="namespacevertical__grid.html#acdec9eefca7e3a8080ced48c2119d79b" title="Interpolate value z value along a y&#45;z line. " alt="" coords="404,71,563,112"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a285097ba1d5a12fad5e8e5cfff4f3844_icgraph.png" border="0" usemap="#namespacevertical__grid_a285097ba1d5a12fad5e8e5cfff4f3844_icgraph" alt=""/></div>
<map name="namespacevertical__grid_a285097ba1d5a12fad5e8e5cfff4f3844_icgraph" id="namespacevertical__grid_a285097ba1d5a12fad5e8e5cfff4f3844_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#a5041a37d436b5526b1941a48e13f48cc" title="Get the strength and sediment content values for a cell. " alt="" coords="197,35,313,76"/>
<area shape="rect" id="node3" href="namespaceplatform__erosion__module.html#a0d5710fa3ad3969b963d00d269cc50e8" title="Apply platform erosion to the whole beach. " alt="" coords="361,35,528,76"/>
<area shape="rect" id="node4" href="namespacetimestep__module.html#ab7438249ea2939c60b42804aea100c8d" title="timestep_module::update" alt="" coords="576,42,744,69"/>
<area shape="rect" id="node5" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="792,5,919,47"/>
<area shape="rect" id="node6" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="967,42,1101,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5041a37d436b5526b1941a48e13f48cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::get_cell_values </td>
          <td>(</td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>zValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>yIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>section</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(out)&#160;</td>
          <td class="paramname"><em>strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(out)&#160;</td>
          <td class="paramname"><em>sediment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the strength and sediment content values for a cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">zvalue</td><td>Z value relatice to OD of a point within the cell</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yindex</td><td>Horizontal index to left of cell</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">section</td><td>Beach section index</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">strength</td><td>Strength value for cell</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sediment</td><td>Secidment content value for cell </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00718">718</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a5041a37d436b5526b1941a48e13f48cc_cgraph.png" border="0" usemap="#namespacevertical__grid_a5041a37d436b5526b1941a48e13f48cc_cgraph" alt=""/></div>
<map name="namespacevertical__grid_a5041a37d436b5526b1941a48e13f48cc_cgraph" id="namespacevertical__grid_a5041a37d436b5526b1941a48e13f48cc_cgraph">
<area shape="rect" id="node2" href="namespaceexceptions.html#adb88d6f61ab18ab53a1d0c7c7022af3c" title="Log a failure message. " alt="" coords="169,19,353,46"/>
<area shape="rect" id="node3" href="namespacevertical__grid.html#a285097ba1d5a12fad5e8e5cfff4f3844" title="Returns an int indicating whether the HA grid cell of interest is empty, or which of the base geology..." alt="" coords="189,71,333,112"/>
<area shape="rect" id="node4" href="namespacevertical__grid.html#a5ccdc45c90a72e9e81c12d62774b9df9" title="Returns the base profile value at a cell boundary. " alt="" coords="417,5,544,47"/>
<area shape="rect" id="node6" href="namespacevertical__grid.html#aa8a0f3f7432908ec2daf1fb5803bf12a" title="Interpolate value y value along a y&#45;z line. " alt="" coords="401,71,560,112"/>
<area shape="rect" id="node7" href="namespacevertical__grid.html#a4b5834ac3b074eda245ab5e2cfcdeea2" title="Returns a layer profile value at a cell boundary. " alt="" coords="417,136,544,177"/>
<area shape="rect" id="node5" href="namespacevertical__grid.html#acdec9eefca7e3a8080ced48c2119d79b" title="Interpolate value z value along a y&#45;z line. " alt="" coords="608,71,767,112"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a5041a37d436b5526b1941a48e13f48cc_icgraph.png" border="0" usemap="#namespacevertical__grid_a5041a37d436b5526b1941a48e13f48cc_icgraph" alt=""/></div>
<map name="namespacevertical__grid_a5041a37d436b5526b1941a48e13f48cc_icgraph" id="namespacevertical__grid_a5041a37d436b5526b1941a48e13f48cc_icgraph">
<area shape="rect" id="node2" href="namespaceplatform__erosion__module.html#a0d5710fa3ad3969b963d00d269cc50e8" title="Apply platform erosion to the whole beach. " alt="" coords="169,35,336,76"/>
<area shape="rect" id="node3" href="namespacetimestep__module.html#ab7438249ea2939c60b42804aea100c8d" title="timestep_module::update" alt="" coords="384,42,552,69"/>
<area shape="rect" id="node4" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="600,5,727,47"/>
<area shape="rect" id="node5" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="775,42,909,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afbec2b78b627acc80062bdc83f1943bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::get_layers </td>
          <td>(</td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>success_code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads data giving layer properties. </p>
<p>Reads, validates and interpolates the profiles for the base geology and for the layers above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">success_code</td><td>0: ok, -ive fatal error, +ive warning </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00073">73</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_afbec2b78b627acc80062bdc83f1943bb_cgraph.png" border="0" usemap="#namespacevertical__grid_afbec2b78b627acc80062bdc83f1943bb_cgraph" alt=""/></div>
<map name="namespacevertical__grid_afbec2b78b627acc80062bdc83f1943bb_cgraph" id="namespacevertical__grid_afbec2b78b627acc80062bdc83f1943bb_cgraph">
<area shape="rect" id="node2" href="namespaceexceptions.html#ab1982976e08c1eb3195c39be80d42c76" title="Test allocation result to return success code. " alt="" coords="815,89,965,131"/>
<area shape="rect" id="node3" href="namespacevertical__grid.html#af18a7dc7a165860e65bb9356ed570b55" title="Initialise the variables and arrays used when reading profiles. " alt="" coords="381,5,529,47"/>
<area shape="rect" id="node4" href="namespacevertical__grid.html#a20921b1398088acb37b56f26ccce3cb7" title="Reads base geology data and profile from a file of Y &#45; Z values. " alt="" coords="191,231,307,272"/>
<area shape="rect" id="node5" href="namespaceutilities__module.html#a88861ad97c41598219fab3b77fe685e5" title="Opens a text file for input and return a success_code value. " alt="" coords="383,348,527,389"/>
<area shape="rect" id="node7" href="namespaceexceptions.html#abeff94ba7cb1b2eea71e2ab64b2ba5af" title="Test iostat to return success code. " alt="" coords="603,289,746,331"/>
<area shape="rect" id="node8" href="namespacevertical__grid.html#aac891eaf92b326d9a47f9aaccc56a8cf" title="Reads base geology or layer profile from a file of Y &#45; Z or Y &#45; Depth values. " alt="" coords="394,180,517,221"/>
<area shape="rect" id="node11" href="namespacevertical__grid.html#a08dea04c23cf1e53315d634c7084a5c2" title="Called after all the profile points have been read in. " alt="" coords="187,63,311,104"/>
<area shape="rect" id="node12" href="namespacevertical__grid.html#af91b1ef3732ecbaba17473c83956b5b5" title="Interpolates between points in a base geology or layer profile to set values in the vertical grid..." alt="" coords="169,409,328,451"/>
<area shape="rect" id="node6" href="namespaceutilities__module.html#a9a22dc4f187ed32c895a2404550f749f" title="Support for FluidEarth (OpenMI) logging. " alt="" coords="601,355,748,382"/>
<area shape="rect" id="node9" href="namespaceexceptions.html#adb88d6f61ab18ab53a1d0c7c7022af3c" title="Log a failure message. " alt="" coords="583,173,767,199"/>
<area shape="rect" id="node10" href="namespacevertical__grid.html#ac633158e3ef0d502e66bef5e52b09393" title="Add the next point to the current base geology or layer profile. " alt="" coords="615,224,734,265"/>
<area shape="rect" id="node13" href="namespacevertical__grid.html#aad17c3a4e6499466c0c0cd1616e9d0cb" title="Interpolate values from a user base geology profile or layer profile. " alt="" coords="376,413,535,455"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_afbec2b78b627acc80062bdc83f1943bb_icgraph.png" border="0" usemap="#namespacevertical__grid_afbec2b78b627acc80062bdc83f1943bb_icgraph" alt=""/></div>
<map name="namespacevertical__grid_afbec2b78b627acc80062bdc83f1943bb_icgraph" id="namespacevertical__grid_afbec2b78b627acc80062bdc83f1943bb_icgraph">
<area shape="rect" id="node2" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="169,5,296,47"/>
<area shape="rect" id="node3" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="344,13,479,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6c7cc7c8cc26a468cfb4b46d6fb85603"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::get_y_values_from_profiles </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nYsections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), dimension(nce, nysections), intent(inout)&#160;</td>
          <td class="paramname"><em>cliffy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises cliffy values from the base geology and layer profiles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nysections</td><td>number of beach sections</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nce</td><td>number of cliff elements</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cliffy</td><td>discretised cliff y value </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00418">418</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a6c7cc7c8cc26a468cfb4b46d6fb85603_cgraph.png" border="0" usemap="#namespacevertical__grid_a6c7cc7c8cc26a468cfb4b46d6fb85603_cgraph" alt=""/></div>
<map name="namespacevertical__grid_a6c7cc7c8cc26a468cfb4b46d6fb85603_cgraph" id="namespacevertical__grid_a6c7cc7c8cc26a468cfb4b46d6fb85603_cgraph">
<area shape="rect" id="node2" href="namespaceutilities__module.html#a8b0c19a361be32177bed1fb459b89eca" title="Write logString to the log file and optionally to the screen. " alt="" coords="212,5,391,32"/>
<area shape="rect" id="node3" href="namespacevertical__grid.html#a5ccdc45c90a72e9e81c12d62774b9df9" title="Returns the base profile value at a cell boundary. " alt="" coords="238,57,365,98"/>
<area shape="rect" id="node5" href="namespacevertical__grid.html#a4b5834ac3b074eda245ab5e2cfcdeea2" title="Returns a layer profile value at a cell boundary. " alt="" coords="238,122,365,163"/>
<area shape="rect" id="node6" href="namespacevertical__grid.html#aa8a0f3f7432908ec2daf1fb5803bf12a" title="Interpolate value y value along a y&#45;z line. " alt="" coords="222,187,381,229"/>
<area shape="rect" id="node4" href="namespacevertical__grid.html#acdec9eefca7e3a8080ced48c2119d79b" title="Interpolate value z value along a y&#45;z line. " alt="" coords="439,90,597,131"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a6c7cc7c8cc26a468cfb4b46d6fb85603_icgraph.png" border="0" usemap="#namespacevertical__grid_a6c7cc7c8cc26a468cfb4b46d6fb85603_icgraph" alt=""/></div>
<map name="namespacevertical__grid_a6c7cc7c8cc26a468cfb4b46d6fb85603_icgraph" id="namespacevertical__grid_a6c7cc7c8cc26a468cfb4b46d6fb85603_icgraph">
<area shape="rect" id="node2" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="212,5,339,47"/>
<area shape="rect" id="node3" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="387,13,521,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af18a7dc7a165860e65bb9356ed570b55"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::init_profile_point_storage </td>
          <td>(</td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>success_code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the variables and arrays used when reading profiles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">success_code</td><td>0: ok, -ive fatal error, +ive warning </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00917">917</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_af18a7dc7a165860e65bb9356ed570b55_cgraph.png" border="0" usemap="#namespacevertical__grid_af18a7dc7a165860e65bb9356ed570b55_cgraph" alt=""/></div>
<map name="namespacevertical__grid_af18a7dc7a165860e65bb9356ed570b55_cgraph" id="namespacevertical__grid_af18a7dc7a165860e65bb9356ed570b55_cgraph">
<area shape="rect" id="node2" href="namespaceexceptions.html#ab1982976e08c1eb3195c39be80d42c76" title="Test allocation result to return success code. " alt="" coords="201,5,352,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_af18a7dc7a165860e65bb9356ed570b55_icgraph.png" border="0" usemap="#namespacevertical__grid_af18a7dc7a165860e65bb9356ed570b55_icgraph" alt=""/></div>
<map name="namespacevertical__grid_af18a7dc7a165860e65bb9356ed570b55_icgraph" id="namespacevertical__grid_af18a7dc7a165860e65bb9356ed570b55_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#afbec2b78b627acc80062bdc83f1943bb" title="Reads data giving layer properties. " alt="" coords="201,5,317,47"/>
<area shape="rect" id="node3" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="365,5,492,47"/>
<area shape="rect" id="node4" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="540,13,675,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af91b1ef3732ecbaba17473c83956b5b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::interpolate_profile </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>profile_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>profile_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), dimension(0: ), intent(inout)&#160;</td>
          <td class="paramname"><em>profile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>success_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolates between points in a base geology or layer profile to set values in the vertical grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">profile_start</td><td>Start index within profile_y and _profile_z</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">profile_end</td><td>End index within profile_y and _profile_z</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">profile</td><td>profile values at dy horizontal spacing</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">success_code</td><td>0: ok, -ive fatal error, +ive warning </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00265">265</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_af91b1ef3732ecbaba17473c83956b5b5_cgraph.png" border="0" usemap="#namespacevertical__grid_af91b1ef3732ecbaba17473c83956b5b5_cgraph" alt=""/></div>
<map name="namespacevertical__grid_af91b1ef3732ecbaba17473c83956b5b5_cgraph" id="namespacevertical__grid_af91b1ef3732ecbaba17473c83956b5b5_cgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#aad17c3a4e6499466c0c0cd1616e9d0cb" title="Interpolate values from a user base geology profile or layer profile. " alt="" coords="212,5,371,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_af91b1ef3732ecbaba17473c83956b5b5_icgraph.png" border="0" usemap="#namespacevertical__grid_af91b1ef3732ecbaba17473c83956b5b5_icgraph" alt=""/></div>
<map name="namespacevertical__grid_af91b1ef3732ecbaba17473c83956b5b5_icgraph" id="namespacevertical__grid_af91b1ef3732ecbaba17473c83956b5b5_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#afbec2b78b627acc80062bdc83f1943bb" title="Reads data giving layer properties. " alt="" coords="212,5,328,47"/>
<area shape="rect" id="node3" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="376,5,503,47"/>
<area shape="rect" id="node4" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="551,13,685,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aad17c3a4e6499466c0c0cd1616e9d0cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::interpolate_profile_value </td>
          <td>(</td>
          <td class="paramtype">real(kind=double), dimension(0:), intent(inout)&#160;</td>
          <td class="paramname"><em>profile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>z1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>z2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate values from a user base geology profile or layer profile. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">profile</td><td>profile values at dy horizontal spacing</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>profile vector index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y1</td><td>first point y value</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z1</td><td>first point z value or depth</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y2</td><td>second point y value</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z2</td><td>second point z value or depth </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00320">320</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_aad17c3a4e6499466c0c0cd1616e9d0cb_icgraph.png" border="0" usemap="#namespacevertical__grid_aad17c3a4e6499466c0c0cd1616e9d0cb_icgraph" alt=""/></div>
<map name="namespacevertical__grid_aad17c3a4e6499466c0c0cd1616e9d0cb_icgraph" id="namespacevertical__grid_aad17c3a4e6499466c0c0cd1616e9d0cb_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#af91b1ef3732ecbaba17473c83956b5b5" title="Interpolates between points in a base geology or layer profile to set values in the vertical grid..." alt="" coords="212,5,371,47"/>
<area shape="rect" id="node3" href="namespacevertical__grid.html#afbec2b78b627acc80062bdc83f1943bb" title="Reads data giving layer properties. " alt="" coords="419,5,535,47"/>
<area shape="rect" id="node4" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="583,5,709,47"/>
<area shape="rect" id="node5" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="757,13,892,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa8a0f3f7432908ec2daf1fb5803bf12a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=double) real(kind=double) function vertical_grid::interpolate_y_value </td>
          <td>(</td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>z1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>z2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate value y value along a y-z line. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>z value at which interpolation is required</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y1</td><td>first point y value</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z1</td><td>first point z value or depth</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y2</td><td>second point y value</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z2</td><td>second point z value or depth </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00341">341</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_aa8a0f3f7432908ec2daf1fb5803bf12a_icgraph.png" border="0" usemap="#namespacevertical__grid_aa8a0f3f7432908ec2daf1fb5803bf12a_icgraph" alt=""/></div>
<map name="namespacevertical__grid_aa8a0f3f7432908ec2daf1fb5803bf12a_icgraph" id="namespacevertical__grid_aa8a0f3f7432908ec2daf1fb5803bf12a_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#a6c7cc7c8cc26a468cfb4b46d6fb85603" title="Initialises cliffy values from the base geology and layer profiles. " alt="" coords="404,5,563,47"/>
<area shape="rect" id="node5" href="namespacevertical__grid.html#a285097ba1d5a12fad5e8e5cfff4f3844" title="Returns an int indicating whether the HA grid cell of interest is empty, or which of the base geology..." alt="" coords="212,68,356,109"/>
<area shape="rect" id="node3" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="1041,8,1168,49"/>
<area shape="rect" id="node4" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="1216,45,1351,71"/>
<area shape="rect" id="node6" href="namespacevertical__grid.html#a5041a37d436b5526b1941a48e13f48cc" title="Get the strength and sediment content values for a cell. " alt="" coords="425,71,541,112"/>
<area shape="rect" id="node7" href="namespaceplatform__erosion__module.html#a0d5710fa3ad3969b963d00d269cc50e8" title="Apply platform erosion to the whole beach. " alt="" coords="611,68,777,109"/>
<area shape="rect" id="node8" href="namespacetimestep__module.html#ab7438249ea2939c60b42804aea100c8d" title="timestep_module::update" alt="" coords="825,74,993,101"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acdec9eefca7e3a8080ced48c2119d79b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=double) function vertical_grid::interpolate_z_value </td>
          <td>(</td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>z1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=double), intent(in)&#160;</td>
          <td class="paramname"><em>z2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate value z value along a y-z line. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>y value at which interpolation is required</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y1</td><td>first point y value</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z1</td><td>first point z value or depth</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y2</td><td>second point y value</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z2</td><td>second point z value or depth </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00360">360</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_acdec9eefca7e3a8080ced48c2119d79b_icgraph.png" border="0" usemap="#namespacevertical__grid_acdec9eefca7e3a8080ced48c2119d79b_icgraph" alt=""/></div>
<map name="namespacevertical__grid_acdec9eefca7e3a8080ced48c2119d79b_icgraph" id="namespacevertical__grid_acdec9eefca7e3a8080ced48c2119d79b_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#a7c9ae156ee9ae50059e3b2b2695387a7" title="Cut the base geology and layer profiles to match current cliffy values. " alt="" coords="217,5,333,47"/>
<area shape="rect" id="node3" href="namespacevertical__grid.html#a5ccdc45c90a72e9e81c12d62774b9df9" title="Returns the base profile value at a cell boundary. " alt="" coords="212,136,339,177"/>
<area shape="rect" id="node11" href="namespacevertical__grid.html#a4b5834ac3b074eda245ab5e2cfcdeea2" title="Returns a layer profile value at a cell boundary. " alt="" coords="212,71,339,112"/>
<area shape="rect" id="node4" href="namespacevertical__grid.html#a6c7cc7c8cc26a468cfb4b46d6fb85603" title="Initialises cliffy values from the base geology and layer profiles. " alt="" coords="387,71,545,112"/>
<area shape="rect" id="node7" href="namespacevertical__grid.html#a285097ba1d5a12fad5e8e5cfff4f3844" title="Returns an int indicating whether the HA grid cell of interest is empty, or which of the base geology..." alt="" coords="394,136,538,177"/>
<area shape="rect" id="node5" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="1188,73,1315,115"/>
<area shape="rect" id="node6" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="1363,110,1497,137"/>
<area shape="rect" id="node8" href="namespacevertical__grid.html#a5041a37d436b5526b1941a48e13f48cc" title="Get the strength and sediment content values for a cell. " alt="" coords="593,133,709,175"/>
<area shape="rect" id="node9" href="namespaceplatform__erosion__module.html#a0d5710fa3ad3969b963d00d269cc50e8" title="Apply platform erosion to the whole beach. " alt="" coords="757,133,924,175"/>
<area shape="rect" id="node10" href="namespacetimestep__module.html#ab7438249ea2939c60b42804aea100c8d" title="timestep_module::update" alt="" coords="972,139,1140,166"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4b5834ac3b074eda245ab5e2cfcdeea2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=double) function vertical_grid::layer_profile_value </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>yIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>section</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a layer profile value at a cell boundary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">yindex</td><td>Horizontal index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layer</td><td>Layer index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">section</td><td>Beach section index </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00882">882</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a4b5834ac3b074eda245ab5e2cfcdeea2_cgraph.png" border="0" usemap="#namespacevertical__grid_a4b5834ac3b074eda245ab5e2cfcdeea2_cgraph" alt=""/></div>
<map name="namespacevertical__grid_a4b5834ac3b074eda245ab5e2cfcdeea2_cgraph" id="namespacevertical__grid_a4b5834ac3b074eda245ab5e2cfcdeea2_cgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#acdec9eefca7e3a8080ced48c2119d79b" title="Interpolate value z value along a y&#45;z line. " alt="" coords="180,5,339,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a4b5834ac3b074eda245ab5e2cfcdeea2_icgraph.png" border="0" usemap="#namespacevertical__grid_a4b5834ac3b074eda245ab5e2cfcdeea2_icgraph" alt=""/></div>
<map name="namespacevertical__grid_a4b5834ac3b074eda245ab5e2cfcdeea2_icgraph" id="namespacevertical__grid_a4b5834ac3b074eda245ab5e2cfcdeea2_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#a6c7cc7c8cc26a468cfb4b46d6fb85603" title="Initialises cliffy values from the base geology and layer profiles. " alt="" coords="372,5,531,47"/>
<area shape="rect" id="node5" href="namespacevertical__grid.html#a285097ba1d5a12fad5e8e5cfff4f3844" title="Returns an int indicating whether the HA grid cell of interest is empty, or which of the base geology..." alt="" coords="180,68,324,109"/>
<area shape="rect" id="node3" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="1009,8,1136,49"/>
<area shape="rect" id="node4" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="1184,45,1319,71"/>
<area shape="rect" id="node6" href="namespacevertical__grid.html#a5041a37d436b5526b1941a48e13f48cc" title="Get the strength and sediment content values for a cell. " alt="" coords="393,71,509,112"/>
<area shape="rect" id="node7" href="namespaceplatform__erosion__module.html#a0d5710fa3ad3969b963d00d269cc50e8" title="Apply platform erosion to the whole beach. " alt="" coords="579,68,745,109"/>
<area shape="rect" id="node8" href="namespacetimestep__module.html#ab7438249ea2939c60b42804aea100c8d" title="timestep_module::update" alt="" coords="793,74,961,101"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aac891eaf92b326d9a47f9aaccc56a8cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::read_profile </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>unitNo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>profile_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>profile_start2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>profile_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>base_geology</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>success_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads base geology or layer profile from a file of Y - Z or Y - Depth values. </p>
<p>Validates the profile and adds the profile points to temporary storage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">unitno</td><td>File already open</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>input file name</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">profile_start</td><td>Start index within profile_y and _profile_z</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">profile_start2</td><td>Index within profile_y and _profile_z of the last point before YmaxH</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">profile_end</td><td>End index within profile_y and _profile_z</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">base_geology</td><td>true if reading the base geology profile. false if reading a layer profile</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">success_code</td><td>0: ok, -ive fatal error, +ive warning </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00154">154</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_aac891eaf92b326d9a47f9aaccc56a8cf_cgraph.png" border="0" usemap="#namespacevertical__grid_aac891eaf92b326d9a47f9aaccc56a8cf_cgraph" alt=""/></div>
<map name="namespacevertical__grid_aac891eaf92b326d9a47f9aaccc56a8cf_cgraph" id="namespacevertical__grid_aac891eaf92b326d9a47f9aaccc56a8cf_cgraph">
<area shape="rect" id="node2" href="namespaceexceptions.html#abeff94ba7cb1b2eea71e2ab64b2ba5af" title="Test iostat to return success code. " alt="" coords="197,5,339,47"/>
<area shape="rect" id="node3" href="namespaceexceptions.html#adb88d6f61ab18ab53a1d0c7c7022af3c" title="Log a failure message. " alt="" coords="176,71,360,98"/>
<area shape="rect" id="node4" href="namespacevertical__grid.html#ac633158e3ef0d502e66bef5e52b09393" title="Add the next point to the current base geology or layer profile. " alt="" coords="209,123,327,164"/>
<area shape="rect" id="node5" href="namespaceexceptions.html#ab1982976e08c1eb3195c39be80d42c76" title="Test allocation result to return success code. " alt="" coords="408,123,559,164"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_aac891eaf92b326d9a47f9aaccc56a8cf_icgraph.png" border="0" usemap="#namespacevertical__grid_aac891eaf92b326d9a47f9aaccc56a8cf_icgraph" alt=""/></div>
<map name="namespacevertical__grid_aac891eaf92b326d9a47f9aaccc56a8cf_icgraph" id="namespacevertical__grid_aac891eaf92b326d9a47f9aaccc56a8cf_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#afbec2b78b627acc80062bdc83f1943bb" title="Reads data giving layer properties. " alt="" coords="340,5,456,47"/>
<area shape="rect" id="node5" href="namespacevertical__grid.html#a20921b1398088acb37b56f26ccce3cb7" title="Reads base geology data and profile from a file of Y &#45; Z values. " alt="" coords="176,35,292,76"/>
<area shape="rect" id="node3" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="504,5,631,47"/>
<area shape="rect" id="node4" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="679,13,813,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a08dea04c23cf1e53315d634c7084a5c2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vertical_grid::save_profile_points </td>
          <td>(</td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>success_code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called after all the profile points have been read in. </p>
<p>Allocates permanent storage for profile points and copies the points.</p>
<p>Deallocates temporary storage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">success_code</td><td>0: ok, -ive fatal error, +ive warning </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l01000">1000</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a08dea04c23cf1e53315d634c7084a5c2_cgraph.png" border="0" usemap="#namespacevertical__grid_a08dea04c23cf1e53315d634c7084a5c2_cgraph" alt=""/></div>
<map name="namespacevertical__grid_a08dea04c23cf1e53315d634c7084a5c2_cgraph" id="namespacevertical__grid_a08dea04c23cf1e53315d634c7084a5c2_cgraph">
<area shape="rect" id="node2" href="namespaceexceptions.html#ab1982976e08c1eb3195c39be80d42c76" title="Test allocation result to return success code. " alt="" coords="177,5,328,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacevertical__grid_a08dea04c23cf1e53315d634c7084a5c2_icgraph.png" border="0" usemap="#namespacevertical__grid_a08dea04c23cf1e53315d634c7084a5c2_icgraph" alt=""/></div>
<map name="namespacevertical__grid_a08dea04c23cf1e53315d634c7084a5c2_icgraph" id="namespacevertical__grid_a08dea04c23cf1e53315d634c7084a5c2_icgraph">
<area shape="rect" id="node2" href="namespacevertical__grid.html#afbec2b78b627acc80062bdc83f1943bb" title="Reads data giving layer properties. " alt="" coords="177,5,293,47"/>
<area shape="rect" id="node3" href="namespaceinitialise__module.html#af9414cb6875872432d6cc993285b26a4" title="FluidEarth entry point, also called from RUN_SCAPE. " alt="" coords="341,5,468,47"/>
<area shape="rect" id="node4" href="_r_u_n___s_c_a_p_e_8f90.html#a245c8bb9027892d128342b5a64dd42dd" title="Main program to run SCAPE freestanding. " alt="" coords="516,13,651,39"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ae246916d5b34df364b4702a154ccfa6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer vertical_grid::active_temp_points</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicates which temp arrays are active (1 or 2) </p>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00061">61</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

</div>
</div>
<a class="anchor" id="a68e721b3b8c6bf3080ea7de2c4fcb9e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer vertical_grid::index_limit</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Current dimension of temp arrays. </p>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00062">62</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

</div>
</div>
<a class="anchor" id="a4496d95a390b57e04da287ab7a728e9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer vertical_grid::next_index</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Next subscript in temp arrays. </p>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00063">63</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

</div>
</div>
<a class="anchor" id="a7d4b3aef1beffb7cbe7cea5a4eb75c0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer vertical_grid::nhcells</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of horizontal cells. </p>
<p>Variables used when reading profiles </p>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00054">54</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

</div>
</div>
<a class="anchor" id="a9ec9d55ece6690bda47a5c06766d4546"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=double), dimension(:), allocatable vertical_grid::temp_y_1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Temporary y value storage. </p>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00057">57</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

</div>
</div>
<a class="anchor" id="a1a81934e4a8bf12f697018247e1f949c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=double), dimension(:), allocatable vertical_grid::temp_y_2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Temporary y value storage. </p>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00059">59</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

</div>
</div>
<a class="anchor" id="af9aaf12df89243d36a4e7808323da457"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=double), dimension(:), allocatable vertical_grid::temp_z_1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Temporary z value storage. </p>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00058">58</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

</div>
</div>
<a class="anchor" id="a850f766e5d65ed3c9bad6d8aade0eb22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=double), dimension(:), allocatable vertical_grid::temp_z_2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Temporary z value storage. </p>

<p>Definition at line <a class="el" href="vertical__grid_8f95_source.html#l00060">60</a> of file <a class="el" href="vertical__grid_8f95_source.html">vertical_grid.f95</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacevertical__grid.html">vertical_grid</a></li>
    <li class="footer">Generated on Mon Apr 25 2016 11:28:40 for SCAPE+ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
